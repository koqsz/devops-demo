apiVersion: v1
kind: ConfigMap
metadata:
  name: db-init-config
  labels:
    app: database
data:
  init.sql: |
    CREATE TABLE IF NOT EXISTS tasks (
        id SERIAL PRIMARY KEY,
        title VARCHAR(255) NOT NULL,
        description TEXT DEFAULT '',
        completed BOOLEAN DEFAULT FALSE,
        created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
        updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
    );

    INSERT INTO tasks (title, description) VALUES
        ('DevOps pipeline beállítása', 'GitHub Actions CI/CD pipeline konfigurálás'),
        ('Kubernetes deployment', 'K8s manifesztek elkészítése'),
        ('ArgoCD telepítés', 'GitOps workflow beállítása')
    ON CONFLICT DO NOTHING;
